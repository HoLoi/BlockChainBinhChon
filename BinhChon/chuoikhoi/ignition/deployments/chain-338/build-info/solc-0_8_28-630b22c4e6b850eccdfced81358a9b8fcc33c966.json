{
  "_format": "hh3-sol-build-info-1",
  "id": "solc-0_8_28-630b22c4e6b850eccdfced81358a9b8fcc33c966",
  "solcVersion": "0.8.28",
  "solcLongVersion": "0.8.28+commit.7893614a",
  "userSourceNameMap": {
    "contracts/Voting.sol": "project/contracts/Voting.sol"
  },
  "input": {
    "language": "Solidity",
    "settings": {
      "evmVersion": "cancun",
      "optimizer": {
        "enabled": true,
        "runs": 200
      },
      "outputSelection": {
        "*": {
          "": [
            "ast"
          ],
          "*": [
            "abi",
            "evm.bytecode",
            "evm.deployedBytecode",
            "evm.methodIdentifiers",
            "metadata"
          ]
        }
      },
      "remappings": []
    },
    "sources": {
      "project/contracts/Voting.sol": {
        "content": "// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.28;\r\n\r\n/// @title Voting cho tất cả mọi người\r\ncontract Voting {\r\n    struct Poll {\r\n        string title;\r\n        string description;\r\n        string[] options;\r\n        uint256[] votes;\r\n        uint64 startTime;\r\n        uint64 endTime;\r\n        bool active;\r\n        address creator;\r\n    }\r\n\r\n    address public owner;\r\n    Poll[] private polls;\r\n    mapping(uint256 => mapping(address => bool)) public hasVoted;\r\n\r\n    event PollCreated(\r\n        uint256 indexed pollId,\r\n        string title,\r\n        uint64 startTime,\r\n        uint64 endTime,\r\n        address indexed creator\r\n    );\r\n    event Voted(uint256 indexed pollId, uint256 indexed optionId, address indexed voter);\r\n    event PollClosed(uint256 indexed pollId, address indexed closedBy);\r\n\r\n    modifier onlyOwner() {\r\n        require(msg.sender == owner, \"not-owner\");\r\n        _;\r\n    }\r\n\r\n    constructor() {\r\n        owner = msg.sender;\r\n    }\r\n\r\n    function totalPolls() external view returns (uint256) {\r\n        return polls.length;\r\n    }\r\n\r\n    function createPoll(\r\n        string memory title,\r\n        string memory description,\r\n        string[] memory options,\r\n        uint64 startTime,\r\n        uint64 endTime\r\n    ) external returns (uint256) {\r\n        require(bytes(title).length > 0, \"title-required\");\r\n        require(options.length >= 2, \"need-2-options\");\r\n\r\n        if (startTime == 0) {\r\n            startTime = uint64(block.timestamp);\r\n        }\r\n\r\n        if (endTime != 0) {\r\n            require(endTime > startTime, \"end-after-start\");\r\n        }\r\n\r\n        uint256[] memory emptyVotes = new uint256[](options.length);\r\n\r\n        polls.push(\r\n            Poll({\r\n                title: title,\r\n                description: description,\r\n                options: options,\r\n                votes: emptyVotes,\r\n                startTime: startTime,\r\n                endTime: endTime,\r\n                active: true,\r\n                creator: msg.sender\r\n            })\r\n        );\r\n\r\n        uint256 pollId = polls.length - 1;\r\n        emit PollCreated(pollId, title, startTime, endTime, msg.sender);\r\n        return pollId;\r\n    }\r\n\r\n    function vote(uint256 pollId, uint256 optionId) external {\r\n        require(pollId < polls.length, \"poll-not-found\");\r\n        Poll storage poll = polls[pollId];\r\n        require(poll.active, \"poll-closed\");\r\n        require(optionId < poll.options.length, \"bad-option\");\r\n        require(!hasVoted[pollId][msg.sender], \"already-voted\");\r\n        require(block.timestamp >= poll.startTime, \"not-started\");\r\n        if (poll.endTime != 0) {\r\n            require(block.timestamp <= poll.endTime, \"poll-ended\");\r\n        }\r\n\r\n        poll.votes[optionId] += 1;\r\n        hasVoted[pollId][msg.sender] = true;\r\n        emit Voted(pollId, optionId, msg.sender);\r\n    }\r\n\r\n    function closePoll(uint256 pollId) external onlyOwner {\r\n        require(pollId < polls.length, \"poll-not-found\");\r\n        Poll storage poll = polls[pollId];\r\n        require(poll.active, \"already-closed\");\r\n        poll.active = false;\r\n        emit PollClosed(pollId, msg.sender);\r\n    }\r\n\r\n    function getPoll(uint256 pollId)\r\n        external\r\n        view\r\n        returns (\r\n            string memory title,\r\n            string memory description,\r\n            string[] memory options,\r\n            uint256[] memory votes,\r\n            uint64 startTime,\r\n            uint64 endTime,\r\n            bool active,\r\n            address creator\r\n        )\r\n    {\r\n        require(pollId < polls.length, \"poll-not-found\");\r\n        Poll storage poll = polls[pollId];\r\n        return (\r\n            poll.title,\r\n            poll.description,\r\n            poll.options,\r\n            poll.votes,\r\n            poll.startTime,\r\n            poll.endTime,\r\n            poll.active,\r\n            poll.creator\r\n        );\r\n    }\r\n\r\n    function hasAddressVoted(uint256 pollId, address voter) external view returns (bool) {\r\n        require(pollId < polls.length, \"poll-not-found\");\r\n        return hasVoted[pollId][voter];\r\n    }\r\n}\r\n"
      }
    }
  }
}